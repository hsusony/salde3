@echo off
chcp 65001 >nul
color 0A

echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo โ  Sales Management System - Database Setup                     โ
echo โ  ูุธุงู ุฅุฏุงุฑุฉ ุงููุจูุนุงุช - ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช                  โ
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
echo ๐ ูุฐุง ุงูุณูุฑูุจุช ุณูููู ุจุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุงููุฉ
echo.
echo โ๏ธ  ุชุฃูุฏ ูู:
echo    1. ุชุซุจูุช SQL Server
echo    2. ุชุดุบูู ุฎุฏูุฉ SQL Server
echo    3. ูุฌูุฏ ุตูุงุญูุงุช ุงูุฅุฏุงุฑุฉ
echo.
pause

echo.
echo ๐ ุฌุงุฑู ุงูุชุญูู ูู SQL Server...
sqlcmd -? >nul 2>&1
if %errorlevel% neq 0 (
    color 0C
    echo โ ุฎุทุฃ: ูู ูุชู ุงูุนุซูุฑ ุนูู sqlcmd
    echo    ุงูุฑุฌุงุก ุชุซุจูุช SQL Server ุฃู ุฅุถุงูุฉ sqlcmd ุฅูู PATH
    pause
    exit /b 1
)

echo โ ุชู ุงูุนุซูุฑ ุนูู sqlcmd

echo.
echo ๐ง ุงุฎุชุฑ ุทุฑููุฉ ุงูุงุชุตุงู:
echo    1. Windows Authentication (ููุตู ุจู)
echo    2. SQL Server Authentication
echo.
set /p auth_choice="ุงุฎุชุฑ (1 ุฃู 2): "

if "%auth_choice%"=="1" (
    set "auth_mode=-E"
    echo โ ุณูุชู ุงุณุชุฎุฏุงู Windows Authentication
) else if "%auth_choice%"=="2" (
    set /p sql_user="ุฃุฏุฎู ุงุณู ุงููุณุชุฎุฏู: "
    set /p sql_pass="ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ: "
    set "auth_mode=-U %sql_user% -P %sql_pass%"
    echo โ ุณูุชู ุงุณุชุฎุฏุงู SQL Server Authentication
) else (
    color 0C
    echo โ ุงุฎุชูุงุฑ ุบูุฑ ุตุญูุญ
    pause
    exit /b 1
)

echo.
set /p server_name="ุฃุฏุฎู ุงุณู ุงูุณูุฑูุฑ [localhost ุฃู .\SQLEXPRESS]: "
if "%server_name%"=="" set "server_name=localhost"

echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo โ  ุฌุงุฑู ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช...                                โ
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.

REM ุงูุฎุทูุฉ 1: ุงูุฌุฏุงูู ุงูุฃุณุงุณูุฉ
echo [1/6] ๐ ุฅูุดุงุก ุงูุฌุฏุงูู ุงูุฃุณุงุณูุฉ...
sqlcmd -S %server_name% %auth_mode% -i "create_database.sql"
if %errorlevel% neq 0 (
    color 0C
    echo โ ูุดู ูู ุฅูุดุงุก ุงูุฌุฏุงูู ุงูุฃุณุงุณูุฉ
    pause
    exit /b 1
)
echo โ ุชู ุฅูุดุงุก ุงูุฌุฏุงูู ุงูุฃุณุงุณูุฉ

REM ุงูุฎุทูุฉ 2: ุงูุฌุฏุงูู ุงูุฅุถุงููุฉ
echo.
echo [2/6] ๐ ุฅูุดุงุก ุงูุฌุฏุงูู ุงูุฅุถุงููุฉ...
sqlcmd -S %server_name% %auth_mode% -i "02_additional_tables.sql"
if %errorlevel% neq 0 (
    color 0C
    echo โ ูุดู ูู ุฅูุดุงุก ุงูุฌุฏุงูู ุงูุฅุถุงููุฉ
    pause
    exit /b 1
)
echo โ ุชู ุฅูุดุงุก ุงูุฌุฏุงูู ุงูุฅุถุงููุฉ

REM ุงูุฎุทูุฉ 3: ุงูุฅุฌุฑุงุกุงุช ุงููุฎุฒูุฉ
echo.
echo [3/6] โ๏ธ  ุฅูุดุงุก ุงูุฅุฌุฑุงุกุงุช ุงููุฎุฒูุฉ...
sqlcmd -S %server_name% %auth_mode% -i "03_stored_procedures.sql"
if %errorlevel% neq 0 (
    color 0C
    echo โ ูุดู ูู ุฅูุดุงุก ุงูุฅุฌุฑุงุกุงุช ุงููุฎุฒูุฉ
    pause
    exit /b 1
)
echo โ ุชู ุฅูุดุงุก ุงูุฅุฌุฑุงุกุงุช ุงููุฎุฒูุฉ

REM ุงูุฎุทูุฉ 4: ุงูุนุฑูุถ (Views)
echo.
echo [4/6] ๐๏ธ  ุฅูุดุงุก ุงูุนุฑูุถ (Views)...
sqlcmd -S %server_name% %auth_mode% -i "04_views.sql"
if %errorlevel% neq 0 (
    color 0C
    echo โ ูุดู ูู ุฅูุดุงุก ุงูุนุฑูุถ
    pause
    exit /b 1
)
echo โ ุชู ุฅูุดุงุก ุงูุนุฑูุถ

REM ุงูุฎุทูุฉ 5: ุงููุดุบูุงุช (Triggers)
echo.
echo [5/6] โก ุฅูุดุงุก ุงููุดุบูุงุช (Triggers)...
sqlcmd -S %server_name% %auth_mode% -i "05_triggers.sql"
if %errorlevel% neq 0 (
    color 0C
    echo โ ูุดู ูู ุฅูุดุงุก ุงููุดุบูุงุช
    pause
    exit /b 1
)
echo โ ุชู ุฅูุดุงุก ุงููุดุบูุงุช

REM ุงูุฎุทูุฉ 6: ุงูุจูุงูุงุช ุงูุฃูููุฉ
echo.
echo [6/6] ๐พ ุฅุฏุฎุงู ุงูุจูุงูุงุช ุงูุฃูููุฉ...
sqlcmd -S %server_name% %auth_mode% -i "06_initial_data.sql"
if %errorlevel% neq 0 (
    color 0C
    echo โ ูุดู ูู ุฅุฏุฎุงู ุงูุจูุงูุงุช ุงูุฃูููุฉ
    pause
    exit /b 1
)
echo โ ุชู ุฅุฏุฎุงู ุงูุจูุงูุงุช ุงูุฃูููุฉ

echo.
echo.
color 0A
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo โ                     โ ุงูุชูู ุงูุฅุนุฏุงุฏ ุจูุฌุงุญ!                    โ
echo โ                โ Setup Completed Successfully!                โ
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
echo ๐ ุชู ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช: SalesManagementDB
echo ๐ ุนุฏุฏ ุงูุฌุฏุงูู: 27
echo โ๏ธ  ุนุฏุฏ ุงูุฅุฌุฑุงุกุงุช ุงููุฎุฒูุฉ: 10
echo ๐๏ธ  ุนุฏุฏ ุงูุนุฑูุถ: 11
echo โก ุนุฏุฏ ุงููุดุบูุงุช: 15
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo โ                    ุจูุงูุงุช ุงูุฏุฎูู ุงูุงูุชุฑุงุถูุฉ                   โ
echo โ                  Default Login Credentials                    โ
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
echo   ๐ค ุงุณู ุงููุณุชุฎุฏู / Username: admin
echo   ๐ ูููุฉ ุงููุฑูุฑ / Password:  admin123
echo.
echo   โ๏ธ  ุชุญุฐูุฑ: ุบููุฑ ูููุฉ ุงููุฑูุฑ ููุฑุงู!
echo.
echo.
echo ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ:
echo    1. ุงูุชุญ ุงูุชุทุจูู
echo    2. ูู ุจุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
echo    3. ุณุฌู ุงูุฏุฎูู ุจุงุณุชุฎุฏุงู: admin / admin123
echo    4. ุบููุฑ ูููุฉ ุงููุฑูุฑ ูู ุงูุฅุนุฏุงุฏุงุช
echo.
echo ๐ ูููุฒูุฏ ูู ุงููุนูููุงุชุ ุฑุงุฌุน: README_SQL_SERVER.md
echo.
pause
